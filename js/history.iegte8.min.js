/*!
 * History API JavaScript Library v4.0.8
 *
 * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 2013-10-31 16:06
 */
(function(f){var h=!0,j=null,n=!1;function E(){}function k(a,b,c){if(a!=j&&""!==a&&!b)var b=k(),c=b.d,d=b.h,a=""+a,a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?d+a:a:d+"//"+b.g+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b.e+a:c.replace(/[^\/]+$/g,"")+a);else if(a=b?a:e.href,!p||c)a=a.replace(/^[^#]*/,"")||"#",a=e.protocol+"//"+e.host+l.basepath+a.replace(RegExp("^#[/]?(?:"+l.type+")?"),"");J.href=a;var a=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(J.href),b=
a[2]+(a[3]?":"+a[3]:""),c=a[4]||"/",d=a[5]||"",f="#"===a[6]?"":a[6]||"",g=c+d+f,i=c.replace(RegExp("^"+l.basepath,"i"),l.type)+d;return{b:a[1]+"//"+b+g,h:a[1],g:b,i:a[2],k:a[3]||"",d:c,e:d,a:f,c:g,j:i,f:i+f}}function X(){var a="";if(u)a+=u.getItem(y);else{var b=g.cookie.split(y+"=");1<b.length&&(a+=b.pop().split(";").shift()||"null")}try{m=z.parse(a)||{}}catch(c){m={}}o(r+"unload",function(){if(u)u.setItem(y,z.stringify(m));else{var a={};if(a[e.href]=i.state)g.cookie=y+"="+z.stringify(a)}},n)}function A(a,
b,c,d){var c=c||{set:E},e=!c.set,g=!c.get,i={configurable:h,set:function(){e=1},get:function(){g=1}};try{v(a,b,i),a[b]=a[b],v(a,b,c)}catch(k){}if(!e||!g)if(a.__defineGetter__&&(a.__defineGetter__(b,i.get),a.__defineSetter__(b,i.set),a[b]=a[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)),(!e||!g)&&a===f){try{var l=a[b];a[b]=j}catch(p){}if("execScript"in f)f.execScript("Public "+b,"VBScript");else try{v(a,b,{value:E})}catch(q){}a[b]=l}else if(!e||!g)try{try{var m=F.create(a);
v(F.getPrototypeOf(m)===a?m:a,b,c);for(var o in a)"function"===typeof a[o]&&(m[o]=a[o].bind(a));try{d.call(m,m,a)}catch(r){}a=m}catch(s){v(a.constructor.prototype,b,c)}}catch(t){return n}return a}function Y(a,b,c){c=c||{};a=a===K?e:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function B(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),d=s[c];if(d){b="string"===typeof a?b:a;if(b.target==j)for(var e=["target","currentTarget","srcElement","type"];a=
e.pop();)b=A(b,a,{get:"type"===a?function(){return c}:function(){return f}});(("popstate"===c?f.onpopstate:f.onhashchange)||E).call(f,b);for(var e=0,g=d.length;e<g;e++)d[e].call(f,b);return h}return Z(a,b)}function L(){var a=g.createEvent?g.createEvent("Event"):g.createEventObject();a.initEvent?a.initEvent("popstate",n,n):a.type="popstate";a.state=i.state;B(a)}function w(a,b,c,d){p||(b=k(b),b.c!==k().c&&(x=d,c?e.replace("#"+b.f):e.hash=b.f));!C&&a&&(m[e.href]=a);D=n}function M(a){if(x){N!==e.href&&
L();var a=a||f.event,b=k(x,h),c=k();a.oldURL||(a.oldURL=b.b,a.newURL=c.b);b.a!==c.a&&B(a)}x=e.href}function O(a){setTimeout(function(){o("popstate",function(a){N=e.href;C||(a=A(a,"state",{get:function(){return i.state}}));B(a)},n)},0);!p&&a!==h&&i.location&&(P(i.location.hash),D&&(D=n,L()))}function $(a){var a=a||f.event,b;a:{for(b=a.target||a.srcElement;b;){if("A"===b.nodeName)break a;b=b.parentNode}b=void 0}var c="defaultPrevented"in a?a.defaultPrevented:a.returnValue===n;b&&"A"===b.nodeName&&!c&&
(c=k(),b=k(b.getAttribute("href",2)),c.b.split("#").shift()===b.b.split("#").shift()&&b.a&&(c.a!==b.a&&(i.location.hash=b.a),P(b.a),a.preventDefault?a.preventDefault():a.returnValue=n))}function P(a){var b=g.getElementById(a=(a||"").replace(/^#/,""));b&&b.id===a&&"A"===b.nodeName&&(a=b.getBoundingClientRect(),f.scrollTo(G.scrollLeft||0,a.top+(G.scrollTop||0)-(G.clientTop||0)))}if(f.history){var g=f.document,G=g.documentElement,u=j,F=f.Object,z=f.JSON,e=f.location,q=f.history,i=q,H=q.pushState,Q=q.replaceState,
p=!!H,C="state"in q,v=F.defineProperty,R=A({},"t")?{}:g.createElement("a"),r="",I=f.addEventListener?"addEventListener":(r="on")&&"attachEvent",S=f.removeEventListener?"removeEventListener":"detachEvent",T=f.dispatchEvent?"dispatchEvent":"fireEvent",o=f[I],U=f[S],Z=f[T],l={basepath:"/",redirect:0,type:"/"},y="__historyAPI__",J=g.createElement("a"),x=e.href,N="",D=n,m={},s={},t=g.title,aa={onhashchange:j,onpopstate:j},V=function(a,b){var c=f.history!==q;c&&(f.history=q);a.apply(q,b);c&&(f.history=
i)},W={redirect:function(a,b){l.basepath=b=b==j?l.basepath:b;l.type=a=a==j?l.type:a;if(f.top==f.self){var c=k(j,n,h).c,d=e.pathname+e.search;p?(d=d.replace(/([^\/])$/,"$1/"),c!=b&&RegExp("^"+b+"$","i").test(d)&&e.replace(c)):d!=b&&(d=d.replace(/([^\/])\?/,"$1/?"),RegExp("^"+b,"i").test(d)&&e.replace(b+"#"+d.replace(RegExp("^"+b,"i"),a)+e.hash))}},pushState:function(a,b,c){var d=g.title;t!=j&&(g.title=t);H&&V(H,arguments);w(a,c);g.title=d;t=b},replaceState:function(a,b,c){var d=g.title;t!=j&&(g.title=
t);delete m[e.href];Q&&V(Q,arguments);w(a,c,h);g.title=d;t=b},location:{set:function(a){f.location=a},get:function(){return p?e:R}},state:{get:function(){return m[e.href]||j}}},K={assign:function(a){0===(""+a).indexOf("#")?w(j,a):e.assign(a)},reload:function(){e.reload()},replace:function(a){0===(""+a).indexOf("#")?w(j,a,h):e.replace(a)},toString:function(){return this.href},href:{get:function(){return k().b}},protocol:j,host:j,hostname:j,port:j,pathname:{get:function(){return k().d}},search:{get:function(){return k().e}},
hash:{set:function(a){w(j,(""+a).replace(/^(#|)/,"#"),n,x)},get:function(){return k().a}}};(function(){var a=g.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){l[b]=(c||("basepath"===b?"/":"")).replace(/^(0|false)$/,"")});try{u=f.sessionStorage}catch(b){}o(r+"hashchange",M,n);var c=[K,R,aa,f,W,i];C&&delete W.state;for(var d=0;d<c.length;d+=2)for(var e in c[d])if(c[d].hasOwnProperty(e))if("function"===
typeof c[d][e])c[d+1][e]=c[d][e];else{a=Y(c[d],e,c[d][e]);if(!A(c[d+1],e,a,function(a,b){if(b===i)f.history=i=c[d+1]=a}))return U(r+"hashchange",M,n),n;c[d+1]===f&&(s[e]=s[e.substr(2)]=[])}l.redirect&&i.redirect();!C&&z&&X();if(!p)g[I](r+"click",$,n);"complete"===g.readyState?O(h):(!p&&k().c!==l.basepath&&(D=h),o(r+"load",O,n));return h})()&&(i.emulate=!p,f[I]=function(a,b,c){a in s?s[a].push(b):3<arguments.length?o(a,b,c,arguments[3]):o(a,b,c)},f[S]=function(a,b,c){var d=s[a];if(d)for(a=d.length;--a;){if(d[a]===
b){d.splice(a,1);break}}else U(a,b,c)},f[T]=B)}})(window);
